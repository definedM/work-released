
wait(2)
if game.GameId ~= 2316994223 then error("is nto pet simx") end --pet sim x gameid
local LocalSettings = _G.PetSimXSettings132
_G.PetSimXSettings132 = nil

for i, v in pairs(LocalSettings) do
    if tonumber(i) then error('you gave an array...') return end
    if not LocalSettings['DiscordSettings'] then error('Discord Settings arent found') return end
end

local DUserID = tostring(LocalSettings['DiscordSettings']['DUserId']) or ''
local webhookurl = tostring(LocalSettings['DiscordSettings']['webhookurl']) or error('no webhook url given lmao')

getgenv().Version = 1.7 --de barely functional versian i thikn
_G.cooldown = false --disabling this might get the discord account banned if spammed rlly fast
_G.stop = false --stops printing things on disconnect
local vu = game:GetService("VirtualUser")
local plrs = game:GetService("Players")
local LP = plrs.LocalPlayer
local MainUi = LP.PlayerGui:FindFirstChild("Main")
local chat = LP.PlayerGui.Chat.Frame.ChatChannelParentFrame.Frame_MessageLogDisplay.Scroller
local PetSimUIds = {}
local pingAllString = ""
local hideSystem = '||'

repeat task.wait(0.3) until LP.__LOADED.Value
if LocalSettings['PSXXgui'] then loadstring(game:HttpGet('https://raw.githubusercontent.com/si1nnx/psxx/main/g',true))() end
if LocalSettings['AlleexxiGui'] then loadstring(game:HttpGet(('https://raw.githubusercontent.com/Alleexxi/releasedscritps/main/script%20(1).lua'),true))() end

for i = 1, #LocalSettings['DiscordSettings']['OtherIds'] do
    PetSimUIds[i] = LocalSettings['DiscordSettings']['OtherIds'][i]
end

for i = 1, #PetSimUIds do
    pingAllString = pingAllString.." <@"..tostring(PetSimUIds[i]).."> "
end

if not LocalSettings['HideSystemMsgs'] then
    hideSystem = ""
end

local function Dprint(Message, ping, pingall)
    if _G.stop then return end
    local message = tostring(Message) or "given parameter isnt a string u dumas"
    if ping then message = '<@'..DUserID..'> '..message end
    if pingall then message = pingAllString..message end
    repeat task.wait() until _G.cooldown == false
    _G.cooldown = true
    local respons = request({
        Url = webhookurl,
        Method = "POST",
        Headers = {
            ['Content-Type'] = 'application/json'
        },
        Body = game:GetService('HttpService'):JSONEncode({content = message or "error when geting message"})
    })
    if not respons.Success then warn("error when printing message: "..message) end
    task.wait(0.8)
    _G.cooldown = false
end

local function GetPLRSinString()
    local StringList = '**Current Players** \n~~-----~~'
    for _, v in pairs(plrs:GetChildren()) do
        if v:IsA("Player") then
            StringList = StringList..'\n*'..v.Name..'*'
        end
    end
    StringList = StringList..'\n~~-----~~'
    return tostring(StringList) or "somtig went wrogn whne grabing plrs"
end

local function getStats()
    local stat
    local CurrencyUI = MainUi.Right
    local function getamount(Name)
        local check = CurrencyUI:FindFirstChild(Name)
        if check then
            return check.Amount.Text 
        end
        return "~~*N/A*~~"
    end
    stat = "*Diamonds* - amount: ["..getamount("Diamonds").."] Rate: ["..getamount("Diamonds2").."]\n*Candy* - amount: ["..getamount("Halloween Candy").."] Rate: ["..getamount("Halloween Candy2")..']'
    stat = stat.."\n\n**Current Boosts** (paid boosts prob dont work cus they were cheated in lul):\n"
    for i, v in pairs(MainUi.Boosts:GetChildren()) do
        if v:IsA("Frame") then
            local Time = v.TimeLeft.Text
            if Time == "" then
                Time = "N/A"
            end
            stat = stat..'*'..v.Name.."*, Time left: ["..Time.."]| "
        end
    end
    return tostring(stat) or "nil"
end

local function IdToHttp(AssetID)
    local ID = string.gsub(tostring(AssetID), "%D", "")
    return "https://www.roblox.com/library/"..tostring(ID) or "image didnt get taken corectly"
end

local function GetMerchantData()
    local data
    local merchant = LP.PlayerGui.Merchant.Frame.Container
    local retries = 0
    repeat
        task.wait(0.6)
        for i, v in ipairs(merchant:GetChildren()) do
            local PetInfo
            repeat
                task.wait(0.5)
                PetInfo = v.Item:FindFirstChildWhichIsA("GuiBase")
            until PetInfo
            data = data.."**Pet Image**: "..IdToHttp(PetInfo.PetIcon.Image).." |**Pet Power**: ["..PetInfo.Level.Text.."]|**Cost**: ["..v.CostFrame.Cost.Text.."]|**Required Respect**: ["..v.Name.."]\n"
        end
        retries += 1
    until data or retries > 8
    return tostring(data) 
end

local function unIdle()
    local i = 0
    repeat
    task.wait()
        vu:ClickButton2(Vector2.new())
        vu:Button2Down(Vector2.new(0,0),workspace.CurrentCamera.CFrame)
        vu:ClickButton1(Vector2.new())
        task.wait()
        vu:Button2Up(Vector2.new(0,0),workspace.CurrentCamera.CFrame)
        vu:MoveMouse(Vector2.new(math.random(1, 100), math.random(1, 100)))
        i += 1
    until i > 11
end

chat.ChildAdded:Connect(function(Item)
    task.wait(2.5)
    if not Item:IsA("Frame") then return end
    local Msg = Item.TextLabel.Text
    local msg = string.lower(Msg)
    local plrchat = false
    local hasname = false
    print(msg)
    if string.find(msg, '  ') then --idk how to find plrchat it just print '   '..theirchat when they do chat 
        plrchat = true
    end
    if string.find(Msg, LP.DisplayName) or string.find(Msg, LP.Name) then --for me
        hasname = true
    end
    if plrchat then Dprint("PlayerChat: "..string.gsub(msg, '%s+', ' '), hasname) 
        return
    end
    -- END OF PLAYER CHATS
    if LocalSettings['DisableSystemMsgPings'] then hasname = false end
    if string.find(msg, 'hatched') or string.find(msg, 'leaving') then
        if string.find(msg, 'a epic') then
            if not LocalSettings['ShowEpicHatch'] then
                return
            end
            if not hasname and not LocalSettings['ShowOthersHatch'] then return end
            Dprint("Egg Hatch: "..Msg)
        end
    end
    if string.find(msg, 'mysterious merchant') then
        local s, e = pcall(function()
            if string.find(msg, 'departed') then Dprint("Mystery merchant has left...", true, true) return end
            local merchantdata = GetMerchantData() or "eror occur when geting merchant's stuff"
            Dprint(merchantdata, true, true)
        end)
        if e then Dprint(e, true, true) end
        return
    end
    Dprint(hideSystem.."SysMsg: "..string.gsub(Msg, '%s+', ' ')..hideSystem, hasname) --make sure there are returns in every special if statemnt when using dis
end)

local Dir = game:GetService("CoreGui"):FindFirstChild("RobloxPromptGui"):FindFirstChild("promptOverlay")
Dir.DescendantAdded:Connect(function(Err)
    if Err.Name == "ErrorTitle" then
        Err:GetPropertyChangedSignal("Text"):Connect(function()
            if Err.Text:sub(0, 12) == "Disconnected" then
                task.wait(0.5)
                Dprint('yuo disconec from gam, reason: '..Dir.ErrorPrompt:FindFirstChild("MessageArea").ErrorFrame.ErrorMessage.Text or "idono de eror is not exis", true)
                _G.stop = true
                return
            end
        end)
    end
end)

plrs.PlayerRemoving:Connect(function(leaving)
    if leaving == LP then Dprint('wyh u leav noob '..leaving.." has left the game "..GetPLRSinString(), true) return end
    Dprint('SysMsg: '..leaving.Name..' has left.')
end)

print"Active"
Dprint("Versien "..tostring(getgenv().Version or 0)..", the playr has entered the gam")

while task.wait(299) do
    unIdle()
    if LocalSettings['ShowStats'] then
        Dprint("5 min mark, dis is ur stat\n"..getStats()..'\n'..GetPLRSinString())
    end
    unIdle()
end
