local requestfunction = syn and syn.request or http and http.request or http_request or fluxus and fluxus.request or getgenv().request or request
local LocalPlayer = game.Players.LocalPlayer
local _NetManaged = game.ReplicatedStorage:WaitForChild("rbxts_include")["node_modules"]["net"]["out"]["_NetManaged"]
local function buywool(woolamount)
	for woolnumber = 1, woolamount, 1 do
		if LocalPlayer.Character and LocalPlayer.Character.Humanoid.Health > 0 then
			_NetManaged.BedwarsPurchaseItem:InvokeServer(
				{shopItem = {price = 0, currency = 0, itemType = "wool_white", amount = 0}}
			)
		end
	end
end
local function checkwool()
	local haswool = false
	
	for i, v in pairs(game.ReplicatedStorage.Inventories:GetDescendants()) do
		if v.Parent.Name == LocalPlayer.Name and v.name == "wool_" .. string.lower(tostring(LocalPlayer.Team.Name)) then
			haswool = true
		end
	end

	wait()
	
	if haswool == false then
		buywool(1)
	end
end
local function convertposition(x, y, z)
    return Vector3.new(math.ceil(x/3), math.ceil(y/3), math.ceil(z/3))
end
local function PlaceBlock(position, blockType)
    _NetManaged.PlaceBlock:InvokeServer(
        {
            ["position"] = position,
            ["blockType"] = blockType
        }
    )
end
local function trapplayer()
    for childnumber, child in pairs(game.Players:GetChildren()) do
        if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") and child ~= LocalPlayer and child.TeamColor ~= LocalPlayer.TeamColor and child.TeamColor ~= game.Teams.Spectators.TeamColor and child.Character and child.Character:FindFirstChild("HumanoidRootPart") then
            local HumanoidRootPart = child.Character:FindFirstChild("HumanoidRootPart")
            
            if (LocalPlayer.Character:FindFirstChild("HumanoidRootPart").Position - HumanoidRootPart.Position).Magnitude <= 45 then -- torso to max build = 90 studs
                local convertedhumanoidrootpartposition = convertposition(HumanoidRootPart.Position.X, HumanoidRootPart.Position.Y, HumanoidRootPart.Position.Z)
                local thresholdminimum = -1
                local thresholdmaximum = 1
                
                for loop_x = thresholdminimum, thresholdmaximum do
                    for loop_y = thresholdminimum, thresholdmaximum do -- get their legs stuck
                        for loop_z = thresholdminimum, thresholdmaximum do
                            coroutine.wrap(function()
                                PlaceBlock(convertedhumanoidrootpartposition + Vector3.new(loop_x, loop_y, loop_z), "wool_" .. string.lower(tostring(LocalPlayer.Team.Name)))
                            end)()
                        end
                    end
                end
            end
        end
    end
end
local function coverbed()
    for childnumber, child in pairs(game.Workspace.Map.Blocks:GetChildren()) do
        if child.Name == "bed" and child.Covers.BrickColor == LocalPlayer.Team.TeamColor then
            local convertedbedposition = convertposition(child.Position.X, child.Position.Y, child.Position.Z)
            local thresholdminimum = -5
            local thresholdmaximum = 5
            
            for loop_x = thresholdminimum, thresholdmaximum do
                for loop_y = 0, thresholdmaximum + 1 do -- floor is a thing lol
                    for loop_z = thresholdminimum, thresholdmaximum do
                        coroutine.wrap(function()
                            PlaceBlock(convertedbedposition + Vector3.new(loop_x, loop_y, loop_z), "wool_" .. string.lower(tostring(LocalPlayer.Team.Name)))
                        end)()
                    end
                end
            end
        end
    end
end

getgenv().window1_tab2_section1_hide_toggled = false
getgenv().window1_tab2_section1_scaffold_toggled = false
getgenv().window1_tab2_section2_wool_toggled = false
-- IU
local IU = loadstring(game:HttpGet("https://raw.githubusercontent.com/araknala/work-released/main/Roblox/Exploits/Libraries/UI/IU.lua"))()

-- window1
local window1 = IU.CreateLib("bedwhores", "theme_warn")

--- window1_tab1
local window1_tab1 = window1:NewTab("info")
local window1_tab1_section1 = window1_tab1:NewSection('usage: click "functions"')
local window1_tab1_section2 = window1_tab1:NewSection("credits:")

window1_tab1_section2:NewButton("creator: araknala#0001", "araknala was here", function()
	setclipboard("araknala#0001")
end)
window1_tab1_section2:NewButton("server: nEyy6rfF", "join the discord server for patch info", function()
	requestfunction({
		Url = "http://127.0.0.1:6463/rpc?v=1",
		Method = "POST",
		Headers = {
			["Content-Type"] = "application/json",
			["Origin"] = "https://discord.com"
		},
		Body = game:GetService("HttpService"):JSONEncode({
			cmd = "INVITE_BROWSER",
			args = {
				code = "nEyy6rfF"
			},
			nonce = game:GetService("HttpService"):GenerateGUID(false)
		}),
	})
	setclipboard("https://www.discord.com/invite/nEyy6rfF")
end)

--- window1_tab2
local window1_tab2 = window1:NewTab("functions")
local window1_tab2_section1 = window1_tab2:NewSection("blocks")
local window1_tab2_section2 = window1_tab2:NewSection("autobuy")
local window1_tab2_section3 = window1_tab2:NewSection("bed")
local blockFolder = Instance.new("Folder")

blockFolder.Name = "blockFolder"
blockFolder.Parent = game.ReplicatedStorage

---- window1_tab2_section1
window1_tab2_section1:NewKeybind("buy", "quickly buy wool", Enum.KeyCode.B, function()
	buywool(1)
end)
window1_tab2_section1:NewKeybind("trap", "suffocates nearby players with wool", Enum.KeyCode.X, function()
    trapplayer()
end)
window1_tab2_section1:NewToggle("hide", "hide the blocks", function(state)
    getgenv().window1_tab2_section1_hide_toggled = state
end)
window1_tab2_section1:NewToggle("scaffold", "build blocks under you", function(state)
	getgenv().window1_tab2_section1_scaffold_toggled = state
end)

---- window1_tab2_section2
window1_tab2_section2:NewToggle("wool", "autobuy wool", function(state)
    getgenv().window1_tab2_section2_wool_toggled = state
end)

---- window1_tab2_section3
window1_tab2_section3:NewKeybind("cover", "covers your bed with wool", Enum.KeyCode.C, function()
    coverbed() -- add neg conv (binary), maybe scale, & loop/renderstep-bind cuz lag
end)

--- window1_tab3
local window1_tab3 = window1:NewTab("settings")
local window1_tab3_section1 = window1_tab3:NewSection("keybinds")

window1_tab3_section1:NewKeybind("toggle ui", "the keybind that toggles the visibility of the ui", Enum.KeyCode.F1, function()
	IU:ToggleUI()
end)

-- misc functions
game:GetService("RunService").RenderStepped:Connect(function()
    --- window1_tab2_section1
    if getgenv().window1_tab2_section1_hide_toggled == true then
        for blocknumber, block in pairs(game.Workspace.Map.Blocks:GetChildren()) do
    		if string.sub(block.Name, 1, 5) == "wool_" then
    			block.Parent = blockFolder
    		end
	    end
	else
		for blocknumber, block in pairs(blockFolder:GetChildren()) do
    		if string.sub(block.Name, 1, 5) == "wool_" then
    			block.Parent = game.Workspace.Map.Blocks
    		end
	    end
    end
    if getgenv().window1_tab2_section1_scaffold_toggled == true then
        -- scaffold math
	else
		-- nil
    end
    
    --- window1_tab2_section2
	if getgenv().window1_tab2_section2_wool_toggled == true then
		checkwool()
	else
		-- nil
	end
end)