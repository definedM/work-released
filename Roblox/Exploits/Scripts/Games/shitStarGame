-- game link: https://www.roblox.com/games/8781849572/shityfackingstargame
--[[ sample inputs for getgenv().Targets, remove the others when executing
getgenv().Targets = "All"
getgenv().Targets = {"someRandomKid_121", LP.Name, "insertValidUsername"}
getgenv().Targets = {LP.Name}
loadstring(game:HttpGet("https://github.com/definedM/wrk-relesd/blob/main/Roblox/Exploits/Scripts/Games/shitStarGame", true))()

]]

local LP = game.Players.LocalPlayer

getgenv().Targets = getgenv().Targets or {LP.Name}
local function brekthing(item, tool)
	game:GetService("ReplicatedStorage").Attack.UpdateHPEvent:FireServer(item, tool)
end

local function RobResource(Parent, Tab, ToolName)
	for _, item in pairs(Tab) do
		coroutine.wrap(function()
			local HP = item.HP
			for i = 1, HP.Value do
				brekthing(item, ToolName)
				task.wait()
			end
			
			local checkHP = HP.Changed:Connect(function(hp)
				if hp == 0 then return end
				brekthing(item, ToolName)
			end)
			local checkParent
			checkParent = Parent.DescendantRemoving:Connect(function()
				checkHP:Disconnect()
				checkParent:Disconnect()
			end) --prevent memory leaks
			return
		end)()
	end
end

local function GetAndStealResources(PlayerName) --lol u can do this to other players' islands but do that urself smh
	local treeTab, oresTab = {}, {}
	local Star = workspace["Star_"..PlayerName].Player
	
	for i, v in pairs(Star.Land:GetChildren()) do
		local Trees = v:FindFirstChild("Tree")
		if Trees then
			Trees = Trees:FindFirstChildOfClass("Folder")
			task.wait()
			for i, tree in pairs(Trees:GetChildren()) do
				if tree:IsA("Model") then
					treeTab[#treeTab+1] = tree
				end
			end	
		end
		
		local Ores = v:FindFirstChild("Ore")
		if Ores then
			Ores = Ores:FindFirstChildOfClass("Folder")
			task.wait()
			for i, ore in pairs(Ores:GetChildren()) do
				if ore:IsA("Model") then 
					oresTab[#oresTab+1] = ore
				end
			end	
		end
	end
	RobResource(Star.Land, treeTab, "Axe")
	RobResource(Star.Land, oresTab, "Pickaxe")
	print("Farming star from player: "..PlayerName)
	return
end

print("Gettings stars, this may take a minute.")

if getgenv().Targets then
	if getgenv().Targets == "All" then
		getgenv().Targets = {}
		for i, plr in pairs(game.Players:GetChildren()) do
			 table.insert(getgenv().Targets, plr.Name)
			GetAndStealResources(plr.Name)
		end
		
		coroutine.wrap(function()
			game.Players.PlayerAdded:Connect(function(plr)
				local StarLoaded = workspace:WaitForChild("Star_"..plr.Name)
				task.wait(2) --wait for children to load soo
				GetAndStealResources(plr.Name)
			end)
		end)
	elseif typeof(getgenv().Targets) == "table" then
		for i, plr in pairs(getgenv().Targets) do
			GetAndStealResources(plr.Name)
		end
	else
		warn('getgenv().Targets must include a table of names or be "All". Farming your own resources for now.')
		GetAndStealResources(LP.Name)
	end
else
	warn("You need a value for getgenv().Targets")
end

print("Star shittr script complete lo")
